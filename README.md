# üé¨ Online Cinema API

**FastAPI-–¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è –æ–Ω–ª–∞–π–Ω-–∫—ñ–Ω–æ—Ç–µ–∞—Ç—Ä—É.**  
–î–µ–ø–ª–æ–π –≤–∏–∫–æ–Ω–∞–Ω–æ –Ω–∞ AWS EC2, –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é:

üëâ **[http://63.180.135.237/docs](http://63.180.135.237/docs)**

---

## üîß –û—Å–Ω–æ–≤–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó

| –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—è | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|-------------|--------------|
| **FastAPI** | –ë–µ–∫–µ–Ω–¥ —Ç–∞ OpenAPI-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è |
| **SQLite** | –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö |
| **SQLAlchemy (async)** | ORM |
| **Celery + Redis** | –§–æ–Ω–æ–≤—ñ –∑–∞–¥–∞—á—ñ |
| **Mailhog** | –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ email |
| **Docker & Docker Compose** | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è |
| **Nginx** | –†–µ–≤–µ—Ä—Å-–ø—Ä–æ–∫—Å—ñ –¥–ª—è –¥–æ—Å—Ç—É–ø—É –∑–∑–æ–≤–Ω—ñ |

---

## ‚öôÔ∏è Environment Variables

–°—Ç–≤–æ—Ä–∏ —Ñ–∞–π–ª `.env` —É –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ—î–∫—Ç—É –∑ —Ç–∞–∫–∏–º –≤–º—ñ—Å—Ç–æ–º:

```bash
DATABASE_URL=sqlite+aiosqlite:///./online_cinema.db
EMAIL_HOST=mailhog
EMAIL_PORT=1025
EMAIL_USE_TLS=False
EMAIL_USER=
EMAIL_PASSWORD=
SECRET_KEY=supersecret
STRIPE_SECRET_KEY=your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret
```
‚ö†Ô∏è–¶–µ–π .env –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫—É, —Ç–∞–∫ —ñ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –≤ Docker.

## üöÄ –õ–æ–∫–∞–ª—å–Ω–∏–π –∑–∞–ø—É—Å–∫
```bash
# –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
git clone https://github.com/msubchak/online-cinema.git

cd online-cinema
# –ó–∞–ø—É—Å–∫ —É—Å—ñ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤
docker compose up --build

```
## Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∑–∞ –∞–¥—Ä–µ—Å–æ—é:
```bash
http://localhost:8000/docs
```

## üåç –ü—Ä–æ–¥–∞–∫—à–Ω (AWS)

API —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ —É **Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö** –∑ **Nginx-–ø—Ä–æ–∫—Å—ñ**.

| –ü–æ—Ä—Ç | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|------|--------------|
| **80** | HTTP-–¥–æ—Å—Ç—É–ø –¥–æ FastAPI —á–µ—Ä–µ–∑ Nginx |
| **8025** | Mailhog (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ email-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å) |

üìç **Swagger UI (–ø—É–±–ª—ñ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø)**:  
üëâ [http://63.180.135.237/docs](http://63.180.135.237/docs)

---

## üß© –û—Å–Ω–æ–≤–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏
### üë§ Accounts (`/api/v1/accounts/`)
| –ú–µ—Ç–æ–¥ | –ï–Ω–¥–ø–æ—ñ–Ω—Ç | –û–ø–∏—Å |
|--------|-----------|------|
| `POST` | `/register/` | –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ |
| `POST` | `/activate/` | –ê–∫—Ç–∏–≤–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —á–µ—Ä–µ–∑ email |
| `POST` | `/login/` | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ |
| `POST` | `/logout/` | –í–∏—Ö—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ |
| `POST` | `/change-password/` | –ó–º—ñ–Ω–∞ –ø–∞—Ä–æ–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ |
| `POST` | `/reset-password/request/` | –ó–∞–ø–∏—Ç –Ω–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è |
| `POST` | `/reset-password/complete/` | –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Å–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è |
| `POST` | `/token/refresh/` | –û–Ω–æ–≤–ª–µ–Ω–Ω—è JWT —Ç–æ–∫–µ–Ω–∞ |
| `POST` | `/admin/change-user-group/` | –ó–º—ñ–Ω–∞ —Ä–æ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ *(ADMIN)* |
| `POST` | `/admin/activate-user/` | –ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ *(ADMIN)* |
| `POST` | `/resend-activation/` | –ü–æ–≤—Ç–æ—Ä–Ω–µ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ª–∏—Å—Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó |

---

### üéû Movies (`/api/v1/movies/`)
| –ú–µ—Ç–æ–¥ | –ï–Ω–¥–ø–æ—ñ–Ω—Ç | –û–ø–∏—Å |
|--------|-----------|------|
| `GET` | `/` | –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö —Ñ—ñ–ª—å–º—ñ–≤ |
| `POST` | `/` | –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ñ—ñ–ª—å–º *(MODERATOR/ADMIN)* |
| `GET` | `/{movie_id}/` | –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ —Ñ—ñ–ª—å–º—É –∑–∞ ID |
| `PATCH` | `/{movie_id}` | –û–Ω–æ–≤–∏—Ç–∏ —Ñ—ñ–ª—å–º *(MODERATOR/ADMIN)* |
| `DELETE` | `/{movie_id}` | –í–∏–¥–∞–ª–∏—Ç–∏ —Ñ—ñ–ª—å–º *(ADMIN)* |
---

### üß© Genres (`/api/v1/genres/`)
| –ú–µ—Ç–æ–¥ | –ï–Ω–¥–ø–æ—ñ–Ω—Ç | –û–ø–∏—Å |
|--------|-----------|------|
| `GET` | `/` | –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞–≥—ñ–Ω–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä—ñ–≤ |
| `POST` | `/` | –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –∂–∞–Ω—Ä |
| `GET` | `/{genre_id}/` | –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ –∂–∞–Ω—Ä—É –∑–∞ ID |
| `PATCH` | `/{genre_id}/` | –û–Ω–æ–≤–∏—Ç–∏ –∂–∞–Ω—Ä |
| `DELETE` | `/{genre_id}/` | –í–∏–¥–∞–ª–∏—Ç–∏ –∂–∞–Ω—Ä |
---

---

### üåü Stars (`/api/v1/stars/`)
| –ú–µ—Ç–æ–¥ | –ï–Ω–¥–ø–æ—ñ–Ω—Ç | –û–ø–∏—Å |
|--------|-----------|------|
| `GET` | `/` | –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞–≥—ñ–Ω–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–æ—Ä—ñ–≤ |
| `POST` | `/` | –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–æ–≥–æ –∞–∫—Ç–æ—Ä–∞ |
| `GET` | `/{star_id}/` | –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ –∞–∫—Ç–æ—Ä–∞ –∑–∞ ID |
| `PATCH` | `/{star_id}/` | –û–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ –∞–∫—Ç–æ—Ä–∞ |
| `DELETE` | `/{star_id}/` | –í–∏–¥–∞–ª–∏—Ç–∏ –∞–∫—Ç–æ—Ä–∞ |

---

### üé¨ Directors (`/api/v1/directors/`)
| –ú–µ—Ç–æ–¥ | –ï–Ω–¥–ø–æ—ñ–Ω—Ç | –û–ø–∏—Å |
|--------|-----------|------|
| `GET` | `/` | –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö —Ä–µ–∂–∏—Å–µ—Ä—ñ–≤ |
| `POST` | `/` | –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–æ–≥–æ —Ä–µ–∂–∏—Å–µ—Ä–∞ |
| `GET` | `/{director_id}/` | –û—Ç—Ä–∏–º–∞—Ç–∏ —Ä–µ–∂–∏—Å–µ—Ä–∞ –∑–∞ ID |
| `PATCH` | `/{director_id}/` | –û–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ —Ä–µ–∂–∏—Å–µ—Ä–∞ |
| `DELETE` | `/{director_id}/` | –í–∏–¥–∞–ª–∏—Ç–∏ —Ä–µ–∂–∏—Å–µ—Ä–∞ |

---

### üõí Cart (`/api/v1/cart/`)
| –ú–µ—Ç–æ–¥ | –ï–Ω–¥–ø–æ—ñ–Ω—Ç | –û–ø–∏—Å |
|--------|-----------|------|
| `GET` | `/` | –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—à–∏–∫ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ |
| `POST` | `/` | –î–æ–¥–∞—Ç–∏ —Ñ—ñ–ª—å–º —É –∫–æ—à–∏–∫ |
| `DELETE` | `/{movie_id}` | –í–∏–¥–∞–ª–∏—Ç–∏ —Ñ—ñ–ª—å–º —ñ–∑ –∫–æ—à–∏–∫–∞ |

---

### üßæ Orders (`/api/v1/order/`)
| –ú–µ—Ç–æ–¥ | –ï–Ω–¥–ø–æ—ñ–Ω—Ç | –û–ø–∏—Å |
|--------|-----------|------|
| `POST` | `/` | –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑ –∫–æ—à–∏–∫–∞ |
| `POST` | `/{order_id}/pay` | –û–ø–ª–∞—Ç–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è |
| `POST` | `/{order_id}/cancel` | –°–∫–∞—Å—É–≤–∞—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è |
| `GET` | `/admin/` | –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—Å—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ *(ADMIN)* |

---

### üí≥ Payments (`/api/v1/payment/`)
| –ú–µ—Ç–æ–¥ | –ï–Ω–¥–ø–æ—ñ–Ω—Ç | –û–ø–∏—Å |
|--------|-----------|------|
| `POST` | `/` | –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–ª–∞—Ç—ñ–∂ |
| `GET` | `/` | –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–ª–∞—Ç–µ–∂—ñ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ |
| `POST` | `/webhook` | Stripe Webhook –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ø–ª–∞—Ç–µ–∂—É |
| `GET` | `/admin/` | –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—Å—ñ –ø–ª–∞—Ç–µ–∂—ñ *(ADMIN)* |


## üì¶ –°–µ—Ä–≤—ñ—Å–∏ –≤ Docker

| –°–µ—Ä–≤—ñ—Å | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è |
|---------|--------------|
| **cinema** | FastAPI API |
| **nginx** | HTTP-–ø—Ä–æ–∫—Å—ñ |
| **redis** | –ß–µ—Ä–≥–∞ |
| **celery** | –§–æ–Ω–æ–≤—ñ –∑–∞–¥–∞—á—ñ |
| **mailhog** | –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ—à—Ç–∏ |

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
```
fastapi-online-cinema/
‚îú‚îÄ‚îÄ .github/   # CI/CD –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó GitHub Actions
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ ci.yml
‚îú‚îÄ‚îÄ alembic/   # –ú—ñ–≥—Ä–∞—Ü—ñ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
‚îÇ   ‚îú‚îÄ‚îÄ versions/
‚îÇ   ‚îú‚îÄ‚îÄ env.py
‚îÇ   ‚îú‚îÄ‚îÄ script.py.mako
‚îÇ   ‚îî‚îÄ‚îÄ README
‚îú‚îÄ‚îÄ app/    # –û—Å–Ω–æ–≤–Ω–∞ –ª–æ–≥—ñ–∫–∞ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É
‚îÇ   ‚îú‚îÄ‚îÄ celery_app/       # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞–¥–∞—á—ñ Celery
‚îÇ   ‚îú‚îÄ‚îÄ core/             # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó, –≤–∏–Ω—è—Ç–∫–∏, –±–∞–∑–∞ –¥–∞–Ω–∏—Ö
‚îÇ   ‚îú‚îÄ‚îÄ models/           # SQLAlchemy ORM –º–æ–¥–µ–ª—ñ
‚îÇ   ‚îú‚îÄ‚îÄ routes/           # –ú–∞—Ä—à—Ä—É—Ç–∏ FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ schemas/          # Pydantic-—Å—Ö–µ–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ security/         # –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ç–∞ —Ç–æ–∫–µ–Ω–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/         # –ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ tests/            # Pytest-—Ç–µ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ main.py           # –û—Å–Ω–æ–≤–Ω–∏–π –º–æ–¥—É–ª—å –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É
‚îú‚îÄ‚îÄ docker-compose.yml        # Docker-–∫–æ–º–ø–æ–∑–∏—Ü—ñ—è –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫—É
‚îú‚îÄ‚îÄ docker-compose-prod.yml   # Docker-–∫–æ–Ω—Ñ—ñ–≥ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
‚îú‚îÄ‚îÄ Dockerfile                # –ë—ñ–ª–¥ –æ–±—Ä–∞–∑—É FastAPI
‚îú‚îÄ‚îÄ nginx.conf                # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Nginx-–ø—Ä–æ–∫—Å—ñ
‚îú‚îÄ‚îÄ alembic.ini               # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Alembic
‚îú‚îÄ‚îÄ pyproject.toml            # Poetry + –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ poetry.lock               # –§—ñ–∫—Å–∞—Ü—ñ—è –≤–µ—Ä—Å—ñ–π –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ .env-example              # –ü—Ä–∏–∫–ª–∞–¥ –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â (—à–∞–±–ª–æ–Ω –¥–ª—è .env)
‚îî‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø—Ä–æ—î–∫—Ç—É

```